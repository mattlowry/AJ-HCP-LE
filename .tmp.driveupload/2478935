"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[333],{1794:(e,t,s)=>{s.d(t,{A:()=>n});var a=s(9662),r=s(579);const n=(0,a.A)((0,r.jsx)("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12z"}),"Cancel")},3333:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Z});var a=s(2555),r=s(45),n=s(5043),l=s(6446),i=s(5865),o=s(794),c=s(7254),d=s(7392),u=s(1045),m=s(3845),h=s(1906),x=s(2110),p=s(6494),v=s(8903),A=s(7784),g=s(3193),y=s(9190),j=s(2221),f=s(2143),b=s(4669),_=s(4056),C=s(35),w=s(6600),I=s(5316),S=s(4605),P=s(1962),k=s(9347),z=s(7332),W=s(4770),q=s(9893),B=s(7141),E=s(1794),M=s(3560),R=s(9662),L=s(579);const H=(0,R.A)((0,L.jsx)("path",{d:"M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"}),"Star");var T=s(141);const F=(0,R.A)((0,L.jsx)("path",{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"}),"Home");var N=s(1387),D=s(3260),U=s(6291),O=s(2817),V=s(8003);const G=["children","value","index"];function X(e){const{children:t,value:s,index:n}=e,i=(0,r.A)(e,G);return(0,L.jsx)("div",(0,a.A)((0,a.A)({role:"tabpanel",hidden:s!==n,id:"customer-tabpanel-".concat(n),"aria-labelledby":"customer-tab-".concat(n)},i),{},{children:s===n&&(0,L.jsx)(l.A,{sx:{p:3},children:t})}))}const Y=()=>{var e,t,s,r,R,O,G,Y,Z,J,K,Q;const{id:$}=(0,D.g)(),ee=(0,D.Zp)();(0,V.Io)("CustomerDetail");const[te,se]=(0,n.useState)(null),[ae,re]=(0,n.useState)(!0),[ne,le]=(0,n.useState)(0),[ie,oe]=(0,n.useState)(!1),[ce,de]=(0,n.useState)(!1),[ue,me]=(0,n.useState)({}),[he,xe]=(0,n.useState)(!1),[pe,ve]=(0,n.useState)(null),[Ae,ge]=(0,n.useState)(null),[ye,je]=(0,n.useState)(!1),[fe,be]=(0,n.useState)(null),[_e,Ce]=(0,n.useState)({}),[we,Ie]=(0,n.useState)(!1),Se=n.useCallback((async e=>{try{re(!0);const t=await U.dr.getById(e);se(t.data)}catch(pe){console.error("Error fetching customer:",pe),ee("/customers")}finally{re(!1)}}),[ee]);(0,n.useEffect)((()=>{"new"===$?(de(!0),oe(!0),re(!1),me({first_name:"",last_name:"",email:"",phone:"",customer_type:"residential",street_address:"",city:"",state:"",zip_code:"",company_name:"",preferred_contact_method:"email",notes:""})):$&&"new"!==$?Se(parseInt($)):re(!1)}),[$,Se]);const Pe=(e,t)=>{me((s=>(0,a.A)((0,a.A)({},s),{},{[e]:t})))},ke=(e,t)=>{Ce((s=>(0,a.A)((0,a.A)({},s),{},{[e]:t})))},ze=()=>{je(!1),be(null),Ce({})};if(ae)return(0,L.jsx)(i.A,{children:"Loading customer details..."});if(!ce&&!te)return(0,L.jsx)(i.A,{children:"Customer not found"});const We=null!==te&&void 0!==te&&null!==(e=te.reviews)&&void 0!==e&&e.length?te.reviews.reduce(((e,t)=>e+t.rating),0)/te.reviews.length:0,qe=ie?ue:te,Be=ce?"Add New Customer":ie?"Edit Customer":null===te||void 0===te?void 0:te.full_name;return(0,L.jsxs)(l.A,{children:[(0,L.jsx)(o.A,{open:!!pe,autoHideDuration:6e3,onClose:()=>ve(null),children:(0,L.jsx)(c.A,{severity:"error",onClose:()=>ve(null),children:pe})}),(0,L.jsx)(o.A,{open:!!Ae,autoHideDuration:6e3,onClose:()=>ge(null),children:(0,L.jsx)(c.A,{severity:"success",onClose:()=>ge(null),children:Ae})}),(0,L.jsxs)(l.A,{display:"flex",alignItems:"center",mb:3,children:[(0,L.jsx)(d.A,{onClick:()=>ee("/customers"),sx:{mr:2},children:(0,L.jsx)(z.A,{})}),!ce&&(0,L.jsx)(u.A,{sx:{mr:2,bgcolor:"commercial"===(null===qe||void 0===qe?void 0:qe.customer_type)?"primary.main":"secondary.main"},children:"commercial"===(null===qe||void 0===qe?void 0:qe.customer_type)?(0,L.jsx)(W.A,{}):(0,L.jsx)(q.A,{})}),(0,L.jsxs)(l.A,{flexGrow:1,children:[(0,L.jsx)(i.A,{variant:"h4",component:"h1",children:Be}),!ie&&!ce&&(0,L.jsxs)(l.A,{display:"flex",gap:1,mt:1,children:[(0,L.jsx)(m.A,{label:null===te||void 0===te?void 0:te.customer_type,color:"commercial"===(null===te||void 0===te?void 0:te.customer_type)?"primary":"secondary"}),(0,L.jsx)(m.A,{label:null===te||void 0===te?void 0:te.preferred_contact_method,variant:"outlined"})]})]}),ie?(0,L.jsxs)(l.A,{display:"flex",gap:1,children:[(0,L.jsx)(h.A,{variant:"contained",startIcon:(0,L.jsx)(B.A,{}),onClick:async()=>{try{if(xe(!0),ve(null),ce){const e=await U.dr.create(ue);ge("Customer created successfully!"),ee("/customers/".concat(e.data.id))}else{const e=await U.dr.update(te.id,ue);se(e.data),ge("Customer updated successfully!"),oe(!1)}}catch(pe){var e,t;console.error("Error saving customer:",pe),ve((null===(e=pe.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Error saving customer")}finally{xe(!1)}},disabled:he,children:he?"Saving...":"Save"}),(0,L.jsx)(h.A,{variant:"outlined",startIcon:(0,L.jsx)(E.A,{}),onClick:()=>{ce?ee("/customers"):(oe(!1),me({}))},children:"Cancel"})]}):!ce&&(0,L.jsx)(h.A,{variant:"contained",startIcon:(0,L.jsx)(M.A,{}),onClick:()=>{oe(!0),me(te||{})},children:"Edit"})]}),(0,L.jsx)(x.A,{sx:{mb:3},children:(0,L.jsx)(p.A,{children:ie?(0,L.jsxs)(v.Ay,{container:!0,spacing:3,children:[(0,L.jsx)(v.Ay,{item:!0,xs:12,children:(0,L.jsx)(i.A,{variant:"h6",gutterBottom:!0,children:"Customer Information"})}),(0,L.jsx)(v.Ay,{item:!0,xs:12,sm:6,children:(0,L.jsx)(A.A,{fullWidth:!0,label:"First Name",value:ue.first_name||"",onChange:e=>Pe("first_name",e.target.value),required:!0})}),(0,L.jsx)(v.Ay,{item:!0,xs:12,sm:6,children:(0,L.jsx)(A.A,{fullWidth:!0,label:"Last Name",value:ue.last_name||"",onChange:e=>Pe("last_name",e.target.value),required:!0})}),(0,L.jsx)(v.Ay,{item:!0,xs:12,sm:6,children:(0,L.jsx)(A.A,{fullWidth:!0,label:"Email",type:"email",value:ue.email||"",onChange:e=>Pe("email",e.target.value),required:!0})}),(0,L.jsx)(v.Ay,{item:!0,xs:12,sm:6,children:(0,L.jsx)(A.A,{fullWidth:!0,label:"Phone",value:ue.phone||"",onChange:e=>Pe("phone",e.target.value),required:!0})}),(0,L.jsx)(v.Ay,{item:!0,xs:12,sm:6,children:(0,L.jsxs)(g.A,{fullWidth:!0,required:!0,children:[(0,L.jsx)(y.A,{children:"Customer Type"}),(0,L.jsxs)(j.A,{value:ue.customer_type||"residential",label:"Customer Type",onChange:e=>Pe("customer_type",e.target.value),children:[(0,L.jsx)(f.A,{value:"residential",children:"Residential"}),(0,L.jsx)(f.A,{value:"commercial",children:"Commercial"})]})]})}),(0,L.jsx)(v.Ay,{item:!0,xs:12,sm:6,children:(0,L.jsxs)(g.A,{fullWidth:!0,required:!0,children:[(0,L.jsx)(y.A,{children:"Preferred Contact Method"}),(0,L.jsxs)(j.A,{value:ue.preferred_contact_method||"email",label:"Preferred Contact Method",onChange:e=>Pe("preferred_contact_method",e.target.value),children:[(0,L.jsx)(f.A,{value:"email",children:"Email"}),(0,L.jsx)(f.A,{value:"phone",children:"Phone"}),(0,L.jsx)(f.A,{value:"text",children:"Text"})]})]})}),"commercial"===ue.customer_type&&(0,L.jsx)(v.Ay,{item:!0,xs:12,children:(0,L.jsx)(A.A,{fullWidth:!0,label:"Company Name",value:ue.company_name||"",onChange:e=>Pe("company_name",e.target.value)})}),(0,L.jsx)(v.Ay,{item:!0,xs:12,children:(0,L.jsx)(A.A,{fullWidth:!0,label:"Street Address",value:ue.street_address||"",onChange:e=>Pe("street_address",e.target.value),required:!0})}),(0,L.jsx)(v.Ay,{item:!0,xs:12,sm:4,children:(0,L.jsx)(A.A,{fullWidth:!0,label:"City",value:ue.city||"",onChange:e=>Pe("city",e.target.value),required:!0})}),(0,L.jsx)(v.Ay,{item:!0,xs:12,sm:4,children:(0,L.jsx)(A.A,{fullWidth:!0,label:"State",value:ue.state||"",onChange:e=>Pe("state",e.target.value),required:!0})}),(0,L.jsx)(v.Ay,{item:!0,xs:12,sm:4,children:(0,L.jsx)(A.A,{fullWidth:!0,label:"ZIP Code",value:ue.zip_code||"",onChange:e=>Pe("zip_code",e.target.value),required:!0})}),(0,L.jsx)(v.Ay,{item:!0,xs:12,children:(0,L.jsx)(A.A,{fullWidth:!0,label:"Notes",multiline:!0,rows:4,value:ue.notes||"",onChange:e=>Pe("notes",e.target.value)})})]}):(0,L.jsxs)(v.Ay,{container:!0,spacing:3,children:[(0,L.jsxs)(v.Ay,{item:!0,xs:12,md:6,children:[(0,L.jsx)(i.A,{variant:"h6",gutterBottom:!0,children:"Contact Information"}),(0,L.jsxs)(i.A,{children:["\ud83d\udce7 ",null===te||void 0===te?void 0:te.email]}),(0,L.jsxs)(i.A,{children:["\ud83d\udcde ",null===te||void 0===te?void 0:te.phone]}),(0,L.jsxs)(i.A,{children:["\ud83d\udccd ",null===te||void 0===te?void 0:te.full_address]}),(null===te||void 0===te?void 0:te.company_name)&&(0,L.jsxs)(i.A,{children:["\ud83c\udfe2 ",te.company_name]})]}),(0,L.jsxs)(v.Ay,{item:!0,xs:12,md:6,children:[(0,L.jsx)(i.A,{variant:"h6",gutterBottom:!0,children:"Summary"}),(0,L.jsxs)(i.A,{children:["Properties: ",(null===te||void 0===te||null===(t=te.properties)||void 0===t?void 0:t.length)||0]}),(0,L.jsxs)(i.A,{children:["Reviews: ",(null===te||void 0===te||null===(s=te.reviews)||void 0===s?void 0:s.length)||0,We>0&&(0,L.jsxs)(l.A,{component:"span",display:"inline-flex",alignItems:"center",ml:1,children:[(0,L.jsx)(H,{fontSize:"small",sx:{color:"gold"}}),We.toFixed(1)]})]}),(0,L.jsxs)(i.A,{children:["Customer since: ",null!==te&&void 0!==te&&te.created_at?new Date(te.created_at).toLocaleDateString():"N/A"]})]})]})})}),!ce&&!ie&&(0,L.jsxs)(x.A,{children:[(0,L.jsx)(l.A,{sx:{borderBottom:1,borderColor:"divider"},children:(0,L.jsxs)(b.A,{value:ne,onChange:(e,t)=>{le(t)},children:[(0,L.jsx)(_.A,{label:"Properties (".concat((null===te||void 0===te||null===(r=te.properties)||void 0===r?void 0:r.length)||0,")")}),(0,L.jsx)(_.A,{label:"Contacts (".concat((null===te||void 0===te||null===(R=te.contacts)||void 0===R?void 0:R.length)||0,")")}),(0,L.jsx)(_.A,{label:"Reviews (".concat((null===te||void 0===te||null===(O=te.reviews)||void 0===O?void 0:O.length)||0,")")}),(0,L.jsx)(_.A,{label:"Job History"})]})}),(0,L.jsxs)(X,{value:ne,index:0,children:[(0,L.jsxs)(l.A,{sx:{mb:2,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,L.jsx)(i.A,{variant:"h6",children:"Properties"}),(0,L.jsx)(h.A,{variant:"contained",startIcon:(0,L.jsx)(T.A,{}),onClick:()=>{je(!0),be(null),Ce({customer:null===te||void 0===te?void 0:te.id,property_type:"single_family",street_address:"",city:"",state:"",zip_code:"",has_gfci_outlets:!1,has_afci_breakers:!1})},disabled:we,children:"Add Property"})]}),null!==te&&void 0!==te&&null!==(G=te.properties)&&void 0!==G&&G.length?(0,L.jsx)(v.Ay,{container:!0,spacing:2,children:null===te||void 0===te||null===(Y=te.properties)||void 0===Y?void 0:Y.map((e=>(0,L.jsx)(v.Ay,{item:!0,xs:12,md:6,component:"div",children:(0,L.jsx)(x.A,{variant:"outlined",children:(0,L.jsxs)(p.A,{children:[(0,L.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:1},children:[(0,L.jsxs)(l.A,{sx:{display:"flex",alignItems:"center"},children:[(0,L.jsx)(F,{sx:{mr:1,color:"primary.main"}}),(0,L.jsx)(i.A,{variant:"h6",children:e.property_type.replace("_"," ").replace(/\b\w/g,(e=>e.toUpperCase()))})]}),(0,L.jsxs)(l.A,{children:[(0,L.jsx)(d.A,{size:"small",onClick:()=>(e=>{be(e),je(!0),Ce(e)})(e),disabled:we,children:(0,L.jsx)(M.A,{fontSize:"small"})}),(0,L.jsx)(d.A,{size:"small",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this property?"))try{Ie(!0),await U.Up.delete(e),te&&await Se(te.id),ge("Property deleted successfully!")}catch(pe){var t,s;console.error("Error deleting property:",pe),ve((null===(t=pe.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.message)||"Error deleting property")}finally{Ie(!1)}})(e.id),disabled:we,color:"error",children:(0,L.jsx)(N.A,{fontSize:"small"})})]})]}),(0,L.jsx)(i.A,{gutterBottom:!0,children:e.full_address}),(e.square_footage||e.year_built||e.bedrooms||e.bathrooms)&&(0,L.jsxs)(l.A,{sx:{mb:1},children:[e.square_footage&&(0,L.jsx)(m.A,{label:"".concat(e.square_footage," sq ft"),size:"small",sx:{mr:.5,mb:.5}}),e.year_built&&(0,L.jsx)(m.A,{label:"Built ".concat(e.year_built),size:"small",sx:{mr:.5,mb:.5}}),e.bedrooms&&(0,L.jsx)(m.A,{label:"".concat(e.bedrooms," bed"),size:"small",sx:{mr:.5,mb:.5}}),e.bathrooms&&(0,L.jsx)(m.A,{label:"".concat(e.bathrooms," bath"),size:"small",sx:{mr:.5,mb:.5}})]}),e.main_panel_brand&&(0,L.jsxs)(i.A,{variant:"body2",color:"text.secondary",children:["\ud83d\udd0c Panel: ",e.main_panel_brand," (",e.main_panel_amperage,"A)"]}),e.electrical_last_updated&&(0,L.jsxs)(i.A,{variant:"body2",color:"text.secondary",children:["\u26a1 Last Updated: ",new Date(e.electrical_last_updated).toLocaleDateString()]}),(0,L.jsxs)(l.A,{sx:{mt:1},children:[e.has_gfci_outlets&&(0,L.jsx)(m.A,{label:"GFCI Outlets",size:"small",color:"success",sx:{mr:.5}}),e.has_afci_breakers&&(0,L.jsx)(m.A,{label:"AFCI Breakers",size:"small",color:"success",sx:{mr:.5}})]}),e.notes&&(0,L.jsxs)(i.A,{variant:"body2",sx:{mt:1,fontStyle:"italic"},children:["\ud83d\udcdd ",e.notes]})]})})},e.id)))}):(0,L.jsxs)(l.A,{sx:{textAlign:"center",py:4},children:[(0,L.jsx)(i.A,{color:"text.secondary",gutterBottom:!0,children:"No properties on file"}),(0,L.jsx)(i.A,{variant:"body2",color:"text.secondary",children:"Add a property to track electrical installations and service history"})]})]}),(0,L.jsx)(X,{value:ne,index:1,children:null!==te&&void 0!==te&&null!==(Z=te.contacts)&&void 0!==Z&&Z.length?(0,L.jsx)(v.Ay,{container:!0,spacing:2,children:null===te||void 0===te||null===(J=te.contacts)||void 0===J?void 0:J.map((e=>(0,L.jsx)(v.Ay,{item:!0,xs:12,md:6,component:"div",children:(0,L.jsx)(x.A,{variant:"outlined",children:(0,L.jsxs)(p.A,{children:[(0,L.jsxs)(i.A,{variant:"h6",gutterBottom:!0,children:[e.first_name," ",e.last_name]}),(0,L.jsx)(m.A,{label:e.contact_type,size:"small",sx:{mb:1}}),(0,L.jsxs)(i.A,{children:["\ud83d\udcde ",e.phone]}),e.email&&(0,L.jsxs)(i.A,{children:["\ud83d\udce7 ",e.email]}),e.relationship&&(0,L.jsx)(i.A,{variant:"body2",color:"text.secondary",children:e.relationship})]})})},e.id)))}):(0,L.jsx)(i.A,{color:"text.secondary",children:"No additional contacts on file"})}),(0,L.jsx)(X,{value:ne,index:2,children:null!==te&&void 0!==te&&null!==(K=te.reviews)&&void 0!==K&&K.length?(0,L.jsx)(v.Ay,{container:!0,spacing:2,children:null===te||void 0===te||null===(Q=te.reviews)||void 0===Q?void 0:Q.map((e=>(0,L.jsx)(v.Ay,{item:!0,xs:12,component:"div",children:(0,L.jsx)(x.A,{variant:"outlined",children:(0,L.jsxs)(p.A,{children:[(0,L.jsxs)(l.A,{display:"flex",alignItems:"center",mb:1,children:[(0,L.jsx)(l.A,{display:"flex",mr:2,children:[...Array(5)].map(((t,s)=>(0,L.jsx)(H,{fontSize:"small",sx:{color:s<e.rating?"gold":"lightgray"}},s)))}),(0,L.jsxs)(i.A,{variant:"body2",color:"text.secondary",children:[e.source," \u2022 ",new Date(e.created_at).toLocaleDateString()]}),e.sentiment_label&&(0,L.jsx)(m.A,{label:e.sentiment_label,size:"small",color:"positive"===e.sentiment_label?"success":"negative"===e.sentiment_label?"error":"default",sx:{ml:1}})]}),(0,L.jsx)(i.A,{children:e.review_text})]})})},e.id)))}):(0,L.jsx)(i.A,{color:"text.secondary",children:"No reviews on file"})}),(0,L.jsx)(X,{value:ne,index:3,children:(0,L.jsx)(i.A,{color:"text.secondary",children:"Job history will be available when the jobs module is implemented"})})]}),(0,L.jsxs)(C.A,{open:ye,onClose:ze,maxWidth:"md",fullWidth:!0,children:[(0,L.jsx)(w.A,{children:fe?"Edit Property":"Add New Property"}),(0,L.jsx)(I.A,{children:(0,L.jsxs)(v.Ay,{container:!0,spacing:2,sx:{mt:1},children:[(0,L.jsx)(v.Ay,{item:!0,xs:12,sm:6,children:(0,L.jsxs)(g.A,{fullWidth:!0,required:!0,children:[(0,L.jsx)(y.A,{children:"Property Type"}),(0,L.jsxs)(j.A,{value:_e.property_type||"single_family",label:"Property Type",onChange:e=>ke("property_type",e.target.value),children:[(0,L.jsx)(f.A,{value:"single_family",children:"Single Family"}),(0,L.jsx)(f.A,{value:"townhouse",children:"Townhouse"}),(0,L.jsx)(f.A,{value:"condo",children:"Condo"}),(0,L.jsx)(f.A,{value:"apartment",children:"Apartment"}),(0,L.jsx)(f.A,{value:"commercial",children:"Commercial"}),(0,L.jsx)(f.A,{value:"industrial",children:"Industrial"})]})]})}),(0,L.jsx)(v.Ay,{item:!0,xs:12,sm:6,children:(0,L.jsx)(A.A,{fullWidth:!0,label:"Square Footage",type:"number",value:_e.square_footage||"",onChange:e=>ke("square_footage",parseInt(e.target.value)||null)})}),(0,L.jsx)(v.Ay,{item:!0,xs:12,children:(0,L.jsx)(A.A,{fullWidth:!0,label:"Street Address",value:_e.street_address||"",onChange:e=>ke("street_address",e.target.value),required:!0})}),(0,L.jsx)(v.Ay,{item:!0,xs:12,sm:4,children:(0,L.jsx)(A.A,{fullWidth:!0,label:"City",value:_e.city||"",onChange:e=>ke("city",e.target.value),required:!0})}),(0,L.jsx)(v.Ay,{item:!0,xs:12,sm:4,children:(0,L.jsx)(A.A,{fullWidth:!0,label:"State",value:_e.state||"",onChange:e=>ke("state",e.target.value),required:!0})}),(0,L.jsx)(v.Ay,{item:!0,xs:12,sm:4,children:(0,L.jsx)(A.A,{fullWidth:!0,label:"ZIP Code",value:_e.zip_code||"",onChange:e=>ke("zip_code",e.target.value),required:!0})}),(0,L.jsx)(v.Ay,{item:!0,xs:12,sm:6,children:(0,L.jsx)(A.A,{fullWidth:!0,label:"Year Built",type:"number",value:_e.year_built||"",onChange:e=>ke("year_built",parseInt(e.target.value)||null)})}),(0,L.jsx)(v.Ay,{item:!0,xs:12,sm:3,children:(0,L.jsx)(A.A,{fullWidth:!0,label:"Bedrooms",type:"number",value:_e.bedrooms||"",onChange:e=>ke("bedrooms",parseInt(e.target.value)||null)})}),(0,L.jsx)(v.Ay,{item:!0,xs:12,sm:3,children:(0,L.jsx)(A.A,{fullWidth:!0,label:"Bathrooms",type:"number",inputProps:{step:.5},value:_e.bathrooms||"",onChange:e=>ke("bathrooms",parseFloat(e.target.value)||null)})}),(0,L.jsx)(v.Ay,{item:!0,xs:12,children:(0,L.jsx)(i.A,{variant:"h6",sx:{mt:2,mb:1},children:"Electrical Information"})}),(0,L.jsx)(v.Ay,{item:!0,xs:12,sm:6,children:(0,L.jsx)(A.A,{fullWidth:!0,label:"Main Panel Brand",value:_e.main_panel_brand||"",onChange:e=>ke("main_panel_brand",e.target.value)})}),(0,L.jsx)(v.Ay,{item:!0,xs:12,sm:3,children:(0,L.jsx)(A.A,{fullWidth:!0,label:"Panel Amperage",type:"number",value:_e.main_panel_amperage||"",onChange:e=>ke("main_panel_amperage",parseInt(e.target.value)||null)})}),(0,L.jsx)(v.Ay,{item:!0,xs:12,sm:3,children:(0,L.jsx)(A.A,{fullWidth:!0,label:"Panel Age (years)",type:"number",value:_e.main_panel_age||"",onChange:e=>ke("main_panel_age",parseInt(e.target.value)||null)})}),(0,L.jsx)(v.Ay,{item:!0,xs:12,sm:6,children:(0,L.jsx)(A.A,{fullWidth:!0,label:"Electrical Last Updated",type:"date",InputLabelProps:{shrink:!0},value:_e.electrical_last_updated||"",onChange:e=>ke("electrical_last_updated",e.target.value)})}),(0,L.jsx)(v.Ay,{item:!0,xs:12,sm:6,children:(0,L.jsxs)(l.A,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,L.jsx)(S.A,{control:(0,L.jsx)(P.A,{checked:_e.has_gfci_outlets||!1,onChange:e=>ke("has_gfci_outlets",e.target.checked)}),label:"Has GFCI Outlets"}),(0,L.jsx)(S.A,{control:(0,L.jsx)(P.A,{checked:_e.has_afci_breakers||!1,onChange:e=>ke("has_afci_breakers",e.target.checked)}),label:"Has AFCI Breakers"})]})}),(0,L.jsx)(v.Ay,{item:!0,xs:12,children:(0,L.jsx)(i.A,{variant:"h6",sx:{mt:2,mb:1},children:"Access Information"})}),(0,L.jsx)(v.Ay,{item:!0,xs:12,sm:6,children:(0,L.jsx)(A.A,{fullWidth:!0,label:"Gate Code",value:_e.gate_code||"",onChange:e=>ke("gate_code",e.target.value)})}),(0,L.jsx)(v.Ay,{item:!0,xs:12,sm:6,children:(0,L.jsx)(A.A,{fullWidth:!0,label:"Key Location",value:_e.key_location||"",onChange:e=>ke("key_location",e.target.value)})}),(0,L.jsx)(v.Ay,{item:!0,xs:12,children:(0,L.jsx)(A.A,{fullWidth:!0,label:"Access Instructions",multiline:!0,rows:2,value:_e.access_instructions||"",onChange:e=>ke("access_instructions",e.target.value)})}),(0,L.jsx)(v.Ay,{item:!0,xs:12,children:(0,L.jsx)(i.A,{variant:"h6",sx:{mt:2,mb:1},children:"Emergency Contact"})}),(0,L.jsx)(v.Ay,{item:!0,xs:12,sm:4,children:(0,L.jsx)(A.A,{fullWidth:!0,label:"Emergency Contact Name",value:_e.emergency_contact_name||"",onChange:e=>ke("emergency_contact_name",e.target.value)})}),(0,L.jsx)(v.Ay,{item:!0,xs:12,sm:4,children:(0,L.jsx)(A.A,{fullWidth:!0,label:"Emergency Contact Phone",value:_e.emergency_contact_phone||"",onChange:e=>ke("emergency_contact_phone",e.target.value)})}),(0,L.jsx)(v.Ay,{item:!0,xs:12,sm:4,children:(0,L.jsx)(A.A,{fullWidth:!0,label:"Relationship",value:_e.emergency_contact_relationship||"",onChange:e=>ke("emergency_contact_relationship",e.target.value)})}),(0,L.jsx)(v.Ay,{item:!0,xs:12,children:(0,L.jsx)(A.A,{fullWidth:!0,label:"Notes",multiline:!0,rows:3,value:_e.notes||"",onChange:e=>ke("notes",e.target.value)})})]})}),(0,L.jsxs)(k.A,{children:[(0,L.jsx)(h.A,{onClick:ze,children:"Cancel"}),(0,L.jsx)(h.A,{variant:"contained",onClick:async()=>{try{Ie(!0),ve(null),fe?(await U.Up.update(fe.id,_e),ge("Property updated successfully!")):(await U.dr.addProperty(te.id,_e),ge("Property added successfully!")),te&&await Se(te.id),je(!1),be(null),Ce({})}catch(pe){var e,t;console.error("Error saving property:",pe),ve((null===(e=pe.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Error saving property")}finally{Ie(!1)}},disabled:we,startIcon:(0,L.jsx)(B.A,{}),children:we?"Saving...":fe?"Update Property":"Add Property"})]})]})]})},Z=()=>(0,L.jsx)(O.qw,{componentName:"CustomerDetail",children:(0,L.jsx)(Y,{})})},4770:(e,t,s)=>{s.d(t,{A:()=>n});var a=s(9662),r=s(579);const n=(0,a.A)((0,r.jsx)("path",{d:"M12 7V3H2v18h20V7zM6 19H4v-2h2zm0-4H4v-2h2zm0-4H4V9h2zm0-4H4V5h2zm4 12H8v-2h2zm0-4H8v-2h2zm0-4H8V9h2zm0-4H8V5h2zm10 12h-8v-2h2v-2h-2v-2h2v-2h-2V9h8zm-2-8h-2v2h2zm0 4h-2v2h2z"}),"Business")},6291:(e,t,s)=>{s.d(t,{Ay:()=>h,LP:()=>m,S:()=>c,Up:()=>o,dr:()=>i,l:()=>d,pO:()=>u});var a=s(9722),r=s(4703);const n=a.A.create({baseURL:"http://localhost:8000/api",headers:{"Content-Type":"application/json"},timeout:1e4});n.interceptors.request.use((e=>{var t;e.metadata={startTime:performance.now()};const s=localStorage.getItem("authToken");s&&(e.headers.Authorization="Bearer ".concat(s)),e.headers["X-Requested-With"]="XMLHttpRequest";const a=null===(t=document.querySelector('meta[name="csrf-token"]'))||void 0===t?void 0:t.getAttribute("content");return a&&(e.headers["X-CSRF-Token"]=a),e}),(e=>(r.Fk.handleError(e,{component:"APIService",action:"Request Interceptor",userMessage:"Failed to prepare API request"}),Promise.reject(e)))),n.interceptors.response.use((e=>{var t;const s=e.config,a=performance.now()-((null===(t=s.metadata)||void 0===t?void 0:t.startTime)||0);var n,l;a>2e3&&(console.warn("\u26a0\ufe0f Slow API call: ".concat(null===(n=e.config.method)||void 0===n?void 0:n.toUpperCase()," ").concat(e.config.url," took ").concat(Math.round(a),"ms")),r.Fk.handleError(new Error("Slow API response"),{component:"APIService",action:"Slow Response: ".concat(null===(l=e.config.method)||void 0===l?void 0:l.toUpperCase()," ").concat(e.config.url),userMessage:"API response was slower than expected"}));return e}),(async e=>{var t,a,i,o,c;r.Fk.handleError(e,{component:"APIService",action:"".concat(null===(t=e.config)||void 0===t||null===(a=t.method)||void 0===a?void 0:a.toUpperCase()," ").concat(null===(i=e.config)||void 0===i?void 0:i.url),userMessage:l(e)});if(401===(null===(o=e.response)||void 0===o?void 0:o.status)){const{authService:t}=await s.e(422).then(s.bind(s,1422)),a=await t.refreshToken();if(a&&e.config)return e.config.headers.Authorization="Bearer ".concat(a),n.request(e.config);t.logout()}if(429===(null===(c=e.response)||void 0===c?void 0:c.status)){const t=e.response.headers["retry-after"],s=t?1e3*parseInt(t):1e3;return console.warn("Rate limited. Retrying after ".concat(s,"ms")),new Promise(((t,a)=>{setTimeout((()=>{e.config?n.request(e.config).then(t).catch(a):a(e)}),s)}))}return Promise.reject(e)}));const l=e=>{if(!e.response)return"Network connection error. Please check your internet connection.";const t=e.response.status,s=e.response.data;switch(t){case 400:return(null===s||void 0===s?void 0:s.message)||"Invalid request. Please check your input.";case 401:return"Your session has expired. Please log in again.";case 403:return"You do not have permission to perform this action.";case 404:return"The requested resource was not found.";case 422:return(null===s||void 0===s?void 0:s.message)||"Please check your input and try again.";case 429:return"Too many requests. Please wait a moment and try again.";case 500:return"Server error occurred. Our team has been notified.";case 502:case 503:case 504:return"Service temporarily unavailable. Please try again later.";default:return(null===s||void 0===s?void 0:s.message)||"An unexpected error occurred. Please try again."}},i={getAll:e=>n.get("/customers/",{params:e}),getById:e=>n.get("/customers/".concat(e,"/")),create:e=>n.post("/customers/",e),update:(e,t)=>n.put("/customers/".concat(e,"/"),t),delete:e=>n.delete("/customers/".concat(e,"/")),getProperties:e=>n.get("/customers/".concat(e,"/properties/")),addProperty:(e,t)=>n.post("/customers/".concat(e,"/add_property/"),t),getContacts:e=>n.get("/customers/".concat(e,"/contacts/")),addContact:(e,t)=>n.post("/customers/".concat(e,"/add_contact/"),t),getReviews:e=>n.get("/customers/".concat(e,"/reviews/")),addReview:(e,t)=>n.post("/customers/".concat(e,"/add_review/"),t)},o={getAll:e=>n.get("/properties/",{params:e}),getById:e=>n.get("/properties/".concat(e,"/")),create:e=>n.post("/properties/",e),update:(e,t)=>n.put("/properties/".concat(e,"/"),t),delete:e=>n.delete("/properties/".concat(e,"/"))},c={getAll:e=>n.get("/jobs/",{params:e}),getById:e=>n.get("/jobs/".concat(e,"/")),create:e=>n.post("/jobs/",e),update:(e,t)=>n.put("/jobs/".concat(e,"/"),t),delete:e=>n.delete("/jobs/".concat(e,"/")),updateStatus:(e,t)=>n.patch("/jobs/".concat(e,"/update_status/"),{status:t}),assignTechnicians:(e,t)=>n.patch("/jobs/".concat(e,"/assign_technicians/"),{technician_ids:t})},d={getAll:e=>n.get("/jobs/technicians/",{params:e}),getAvailable:e=>n.get("/jobs/technicians/available/",{params:e}),getById:e=>n.get("/jobs/technicians/".concat(e,"/"))},u={getItems:e=>n.get("/inventory/items/",{params:e}),getItemById:e=>n.get("/inventory/items/".concat(e,"/")),createItem:e=>n.post("/inventory/items/",e),updateItem:(e,t)=>n.put("/inventory/items/".concat(e,"/"),t),deleteItem:e=>n.delete("/inventory/items/".concat(e,"/")),adjustStock:(e,t,s)=>n.post("/inventory/items/".concat(e,"/adjust_stock/"),{quantity:t,reason:s}),getCategories:()=>n.get("/inventory/categories/"),createCategory:e=>n.post("/inventory/categories/",e),getSuppliers:()=>n.get("/inventory/suppliers/"),createSupplier:e=>n.post("/inventory/suppliers/",e),getStockMovements:e=>n.get("/inventory/stock-movements/",{params:e}),getPurchaseOrders:e=>n.get("/inventory/purchase-orders/",{params:e}),createPurchaseOrder:e=>n.post("/inventory/purchase-orders/",e),updatePurchaseOrder:(e,t)=>n.put("/inventory/purchase-orders/".concat(e,"/"),t)},m={getBusinessOverview:()=>n.get("/analytics/analytics/business_overview/"),getFinancialSummary:()=>n.get("/analytics/analytics/financial_summary/"),getOperationalMetrics:()=>n.get("/analytics/analytics/operational_metrics/"),getCustomerInsights:()=>n.get("/analytics/analytics/customer_insights/"),getInventoryInsights:()=>n.get("/analytics/analytics/inventory_insights/")},h=n},8003:(e,t,s)=>{s.d(t,{Io:()=>n,WR:()=>l,pO:()=>r});var a=s(5043);s(3536);const r=(e,t,s)=>(0,a.useMemo)((()=>{const t=performance.now(),s=e();performance.now();return s}),t),n=e=>{const t=(0,a.useRef)(0),s=(0,a.useRef)(0);t.current=performance.now(),(0,a.useEffect)((()=>{s.current=performance.now();s.current,t.current;return()=>{performance.now(),s.current}}),[e]),(0,a.useEffect)((()=>{if(t.current){performance.now(),t.current;0}}))},l=()=>{const e=(0,a.useRef)(new Map);return{get:(0,a.useCallback)((t=>{const s=e.current.get(t);if(s){return Date.now()-s.timestamp>3e5?(e.current.delete(t),null):s.data}return null}),[]),set:(0,a.useCallback)(((t,s)=>{e.current.set(t,{data:s,timestamp:Date.now()})}),[]),clear:(0,a.useCallback)((()=>{e.current.clear()}),[]),size:e.current.size}}},9893:(e,t,s)=>{s.d(t,{A:()=>n});var a=s(9662),r=s(579);const n=(0,a.A)((0,r.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"Person")}}]);
//# sourceMappingURL=333.2c06d993.chunk.js.map